%%
\newcount\@hinputdepth%
\@hinputdepth0\relax%
%%
%%
%% The current directory.
\xdef\currentDir{.}%
%
\expandafter\edef\csname @hdir@0\endcsname{\currentDir}%
%
%
%%%
%%% Input a file #2 located in relative directory path #1
%%%
\protected\gdef\hinput#1#2{%
%
\edef\@cur@hdir{@hdir@\the\@hinputdepth}%
\advance\@hinputdepth by 1%
\edef\@next@hdir{@hdir@\the\@hinputdepth}%
%
\ifx\@my@tex@package@empty#1\@my@tex@package@empty%
\expandafter\xdef\expandafter\currentDir{\expandafter\csname\@cur@hdir\endcsname}%
\else%
\expandafter\xdef\expandafter\currentDir{\expandafter\csname\@cur@hdir\endcsname/#1}%
\fi%
%%
\expandafter\edef\csname\@next@hdir\endcsname{\currentDir}%
\expandafter\input{\currentDir/#2}%
\expandafter\xdef\expandafter\currentDir{\expandafter\csname\@cur@hdir\endcsname}%
\advance\@hinputdepth by -1%
}%
%
